import{j as n}from"./jsx-runtime-Z8WwdQU7.js";import{R as e,r as u}from"./index-BPQRexiR.js";import{h as _,x as Z}from"./components-DpadYxWV.js";import{W as R,c as U,u as D,d as B,e as P,f as L,a as x,I as E,B as d,T as g,g as H,P as W,C as S}from"./Page-D8WNDyj0.js";import{B as G,T as K,L as I,a as l}from"./TitleBar-DSzr8Q50.js";import{u as X}from"./context-C5qbiZyd.js";var T=function(a){return e.createElement("svg",Object.assign({viewBox:"0 0 20 20"},a),e.createElement("path",{d:"M10 6a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5a.75.75 0 0 1 .75-.75Z"}),e.createElement("path",{d:"M11 13a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"}),e.createElement("path",{fillRule:"evenodd",d:"M11.237 3.177a1.75 1.75 0 0 0-2.474 0l-5.586 5.585a1.75 1.75 0 0 0 0 2.475l5.586 5.586a1.75 1.75 0 0 0 2.474 0l5.586-5.586a1.75 1.75 0 0 0 0-2.475l-5.586-5.585Zm-1.414 1.06a.25.25 0 0 1 .354 0l5.586 5.586a.25.25 0 0 1 0 .354l-5.586 5.585a.25.25 0 0 1-.354 0l-5.586-5.585a.25.25 0 0 1 0-.354l5.586-5.586Z"}))};T.displayName="AlertDiamondIcon";var A=function(a){return e.createElement("svg",Object.assign({viewBox:"0 0 20 20"},a),e.createElement("path",{d:"M10 6.75a.75.75 0 0 1 .75.75v3.5a.75.75 0 1 1-1.5 0v-3.5a.75.75 0 0 1 .75-.75Z"}),e.createElement("path",{d:"M11 13.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"}),e.createElement("path",{fillRule:"evenodd",d:"M10 3.5c-1.045 0-1.784.702-2.152 1.447a449.26 449.26 0 0 1-2.005 3.847l-.028.052a403.426 403.426 0 0 0-2.008 3.856c-.372.752-.478 1.75.093 2.614.57.863 1.542 1.184 2.464 1.184h7.272c.922 0 1.895-.32 2.464-1.184.57-.864.465-1.862.093-2.614-.21-.424-1.113-2.147-2.004-3.847l-.032-.061a429.497 429.497 0 0 1-2.005-3.847c-.368-.745-1.107-1.447-2.152-1.447Zm-.808 2.112c.404-.816 1.212-.816 1.616 0 .202.409 1.112 2.145 2.022 3.88a418.904 418.904 0 0 1 2.018 3.875c.404.817 0 1.633-1.212 1.633h-7.272c-1.212 0-1.617-.816-1.212-1.633.202-.408 1.113-2.147 2.023-3.883a421.932 421.932 0 0 0 2.017-3.872Z"}))};A.displayName="AlertTriangleIcon";var N=function(a){return e.createElement("svg",Object.assign({viewBox:"0 0 20 20"},a),e.createElement("path",{fillRule:"evenodd",d:"M15.78 5.97a.75.75 0 0 1 0 1.06l-6.5 6.5a.75.75 0 0 1-1.06 0l-3.25-3.25a.75.75 0 1 1 1.06-1.06l2.72 2.72 5.97-5.97a.75.75 0 0 1 1.06 0Z"}))};N.displayName="CheckIcon";var F=function(a){return e.createElement("svg",Object.assign({viewBox:"0 0 20 20"},a),e.createElement("path",{d:"M10 14a.75.75 0 0 1-.75-.75v-3.5a.75.75 0 0 1 1.5 0v3.5a.75.75 0 0 1-.75.75Z"}),e.createElement("path",{d:"M9 7a1 1 0 1 1 2 0 1 1 0 0 1-2 0Z"}),e.createElement("path",{fillRule:"evenodd",d:"M17 10a7 7 0 1 1-14 0 7 7 0 0 1 14 0Zm-1.5 0a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0Z"}))};F.displayName="InfoIcon";var O=function(a){return e.createElement("svg",Object.assign({viewBox:"0 0 20 20"},a),e.createElement("path",{d:"M12.72 13.78a.75.75 0 1 0 1.06-1.06l-2.72-2.72 2.72-2.72a.75.75 0 0 0-1.06-1.06l-2.72 2.72-2.72-2.72a.75.75 0 0 0-1.06 1.06l2.72 2.72-2.72 2.72a.75.75 0 1 0 1.06 1.06l2.72-2.72 2.72 2.72Z"}))};O.displayName="XIcon";var v={Banner:"Polaris-Banner",keyFocused:"Polaris-Banner--keyFocused",withinContentContainer:"Polaris-Banner--withinContentContainer",withinPage:"Polaris-Banner--withinPage",DismissIcon:"Polaris-Banner__DismissIcon","text-success-on-bg-fill":"Polaris-Banner--textSuccessOnBgFill","text-success":"Polaris-Banner__text--success","text-warning-on-bg-fill":"Polaris-Banner--textWarningOnBgFill","text-warning":"Polaris-Banner__text--warning","text-critical-on-bg-fill":"Polaris-Banner--textCriticalOnBgFill","text-critical":"Polaris-Banner__text--critical","text-info-on-bg-fill":"Polaris-Banner--textInfoOnBgFill","text-info":"Polaris-Banner__text--info","icon-secondary":"Polaris-Banner__icon--secondary"};const C={success:{withinPage:{background:"bg-fill-success",text:"text-success-on-bg-fill",icon:"text-success-on-bg-fill"},withinContentContainer:{background:"bg-surface-success",text:"text-success",icon:"text-success"},icon:N},warning:{withinPage:{background:"bg-fill-warning",text:"text-warning-on-bg-fill",icon:"text-warning-on-bg-fill"},withinContentContainer:{background:"bg-surface-warning",text:"text-warning",icon:"text-warning"},icon:A},critical:{withinPage:{background:"bg-fill-critical",text:"text-critical-on-bg-fill",icon:"text-critical-on-bg-fill"},withinContentContainer:{background:"bg-surface-critical",text:"text-critical",icon:"text-critical"},icon:T},info:{withinPage:{background:"bg-fill-info",text:"text-info-on-bg-fill",icon:"text-info-on-bg-fill"},withinContentContainer:{background:"bg-surface-info",text:"text-info",icon:"text-info"},icon:F}};function Y(t){const a=u.useRef(null),[h,r]=u.useState(!1);return u.useImperativeHandle(t,()=>({focus:()=>{var i;(i=a.current)==null||i.focus(),r(!0)}}),[]),{wrapperRef:a,handleKeyUp:i=>{i.target===a.current&&r(!0)},handleBlur:()=>r(!1),handleMouseUp:i=>{i.currentTarget.blur(),r(!1)},shouldShowFocus:h}}const M=u.forwardRef(function(a,h){const{tone:r,stopAnnouncements:s}=a,o=u.useContext(R),{wrapperRef:c,handleKeyUp:i,handleBlur:m,handleMouseUp:f,shouldShowFocus:p}=Y(h),b=U(v.Banner,p&&v.keyFocused,o?v.withinContentContainer:v.withinPage);return e.createElement(G.Provider,{value:!0},e.createElement("div",{className:b,tabIndex:0,ref:c,role:r==="warning"||r==="critical"?"alert":"status","aria-live":s?"off":"polite",onMouseUp:f,onKeyUp:i,onBlur:m},e.createElement(z,a)))});function z({tone:t="info",icon:a,hideIcon:h,onDismiss:r,action:s,secondaryAction:o,title:c,children:i}){const m=D(),f=u.useContext(R),p=!c&&!f,b=Object.keys(C).includes(t)?t:"info",w=C[b][f?"withinContentContainer":"withinPage"],j={backgroundColor:w.background,textColor:w.text,bannerTitle:c?e.createElement(g,{as:"h2",variant:"headingSm",breakWord:!0},c):null,bannerIcon:h?null:e.createElement("span",{className:v[w.icon]},e.createElement(P,{source:a??C[b].icon})),actionButtons:s||o?e.createElement(L,null,s&&e.createElement(B,Object.assign({onClick:s.onAction},s),s.content),o&&e.createElement(B,Object.assign({onClick:o.onAction},o),o.content)):null,dismissButton:r?e.createElement(B,{variant:"tertiary",icon:e.createElement("span",{className:v[p?"icon-secondary":w.icon]},e.createElement(P,{source:O})),onClick:r,accessibilityLabel:m.translate("Polaris.Banner.dismissButton")}):null},y=i?e.createElement(g,{as:"span",variant:"bodyMd"},i):null;return f?e.createElement($,j,y):p?e.createElement(Q,j,y):e.createElement(V,j,y)}function V({backgroundColor:t,textColor:a,bannerTitle:h,bannerIcon:r,actionButtons:s,dismissButton:o,children:c}){const{smUp:i}=X(),m=c||s;return e.createElement(x,{width:"100%"},e.createElement(d,{align:"space-between"},e.createElement(x,{background:t,color:a,borderStartStartRadius:i?"300":void 0,borderStartEndRadius:i?"300":void 0,borderEndStartRadius:!m&&i?"300":void 0,borderEndEndRadius:!m&&i?"300":void 0,padding:"300"},e.createElement(E,{align:"space-between",blockAlign:"center",gap:"200",wrap:!1},e.createElement(E,{gap:"100",wrap:!1},r,h),o)),m&&e.createElement(x,{padding:{xs:"300",md:"400"},paddingBlockStart:"300"},e.createElement(d,{gap:"200"},e.createElement("div",null,c),s))))}function Q({backgroundColor:t,bannerIcon:a,actionButtons:h,dismissButton:r,children:s}){const[o,c]=u.useState("center"),i=u.useRef(null),m=u.useRef(null),f=u.useRef(null),p=u.useCallback(()=>{var j,y,k;const b=(j=i.current)==null?void 0:j.offsetHeight,w=((y=m.current)==null?void 0:y.offsetHeight)||((k=f.current)==null?void 0:k.offsetHeight);!b||!w||(b>w?c("start"):c("center"))},[]);return u.useEffect(()=>p(),[p]),H("resize",p),e.createElement(x,{width:"100%",padding:"300",borderRadius:"300"},e.createElement(E,{align:"space-between",blockAlign:o,wrap:!1},e.createElement(x,{width:"100%"},e.createElement(E,{gap:"200",wrap:!1,blockAlign:o},a?e.createElement("div",{ref:m},e.createElement(x,{background:t,borderRadius:"200",padding:"100"},a)):null,e.createElement(x,{ref:i,width:"100%"},e.createElement(d,{gap:"200"},e.createElement("div",null,s),h)))),e.createElement("div",{ref:f,className:v.DismissIcon},r)))}function $({backgroundColor:t,textColor:a,bannerTitle:h,bannerIcon:r,actionButtons:s,dismissButton:o,children:c}){return e.createElement(x,{width:"100%",background:t,padding:"200",borderRadius:"200",color:a},e.createElement(E,{align:"space-between",blockAlign:"start",wrap:!1,gap:"200"},e.createElement(E,{gap:"150",wrap:!1},r,e.createElement(x,{width:"100%"},e.createElement(d,{gap:"200"},e.createElement(d,{gap:"050"},h,e.createElement("div",null,c)),s))),o))}const q=new Proxy({},{get(t,a){throw Error(`shopify.${String(a)} can't be used in a server environment. You likely need to move this code into an Effect.`)}});function J(){if(typeof window>"u")return q;if(!window.shopify)throw Error("The shopify global is not defined. This likely means the App Bridge script tag was not added correctly to this page");return window.shopify}function se(){var m;const t=_(),a=J(),h=Z(),[r,s]=u.useState(!1),o=t.state==="submitting"||t.state==="loading";u.useEffect(()=>{var f,p;(f=t.data)!=null&&f.success?(a.toast.show(t.data.message),t.data.alreadyExists||s(!0)):((p=t.data)==null?void 0:p.success)===!1&&a.toast.show("Setup failed: "+(t.data.error||"Unknown error"),{isError:!0})},[t.data,a]);const c=()=>{t.submit({},{method:"POST",action:"/app/setup-metaobject"})},i=()=>{h("/app/submissions")};return n.jsxs(W,{children:[n.jsx(K,{title:"Story App - Dashboard"}),n.jsx(d,{gap:"500",children:n.jsxs(I,{children:[n.jsx(I.Section,{children:n.jsx(S,{children:n.jsxs(d,{gap:"500",children:[n.jsxs(d,{gap:"200",children:[n.jsx(g,{as:"h2",variant:"headingMd",children:"Welcome to Story App"}),n.jsx(g,{variant:"bodyMd",as:"p",children:"This app allows your customers to submit memorial stories that can be displayed on your storefront. Stories are stored as Shopify metaobjects for seamless integration with your theme."})]}),r&&n.jsx(M,{tone:"success",children:n.jsx("p",{children:"Metaobject definition created successfully! You can now start accepting story submissions."})}),n.jsxs(d,{gap:"300",children:[n.jsx(g,{as:"h3",variant:"headingMd",children:"Quick Start"}),n.jsxs(l,{type:"number",children:[n.jsx(l.Item,{children:"Run the initial setup to create the Story metaobject definition (one-time only)"}),n.jsx(l.Item,{children:"Share your public submission form with customers"}),n.jsx(l.Item,{children:"Review and approve submissions in the Submissions page"}),n.jsx(l.Item,{children:"Published stories appear as metaobjects in your Shopify admin"})]})]}),n.jsxs(E,{gap:"300",children:[n.jsx(B,{variant:"primary",loading:o,onClick:c,children:"Run Initial Setup"}),n.jsx(B,{onClick:i,children:"View Submissions"})]}),((m=t.data)==null?void 0:m.definition)&&n.jsx(M,{tone:"info",children:n.jsxs(d,{gap:"200",children:[n.jsxs(g,{as:"p",variant:"bodyMd",children:[n.jsx("strong",{children:"Metaobject Definition:"})," ",t.data.definition.name," (",t.data.definition.type,")"]}),t.data.alreadyExists&&n.jsx(g,{as:"p",variant:"bodyMd",children:"The metaobject definition already exists - no action needed!"})]})})]})})}),n.jsx(I.Section,{variant:"oneThird",children:n.jsxs(d,{gap:"500",children:[n.jsx(S,{children:n.jsxs(d,{gap:"200",children:[n.jsx(g,{as:"h2",variant:"headingMd",children:"Features"}),n.jsxs(l,{children:[n.jsx(l.Item,{children:"Public story submission form"}),n.jsx(l.Item,{children:"Admin submission review dashboard"}),n.jsx(l.Item,{children:"Photo upload support"}),n.jsx(l.Item,{children:"Shopify metaobject integration"}),n.jsx(l.Item,{children:"GDPR compliant data handling"})]})]})}),n.jsx(S,{children:n.jsxs(d,{gap:"200",children:[n.jsx(g,{as:"h2",variant:"headingMd",children:"Public URLs"}),n.jsxs(d,{gap:"200",children:[n.jsx(g,{as:"p",variant:"bodyMd",children:n.jsx("strong",{children:"Submission Form:"})}),n.jsx(g,{as:"p",variant:"bodySm",tone:"subdued",children:"/stories (public memorial wall + form)"}),n.jsx(g,{as:"p",variant:"bodySm",tone:"subdued",children:"/submit-story (standalone form)"})]})]})}),n.jsx(S,{children:n.jsxs(d,{gap:"200",children:[n.jsx(g,{as:"h2",variant:"headingMd",children:"Resources"}),n.jsxs(l,{children:[n.jsx(l.Item,{children:"View DEPLOYMENT_GUIDE.md for production setup"}),n.jsx(l.Item,{children:"Check APP_CONFIG_INFO.md for configuration details"}),n.jsx(l.Item,{children:"Privacy Policy and Terms of Service are available at /privacy-policy and /terms-of-service"})]})]})})]})})]})})]})}export{se as default};
