import{j as e}from"./jsx-runtime-Z8WwdQU7.js";import{r as _}from"./index-BPQRexiR.js";import{F as b}from"./components-DpadYxWV.js";const N="_formSection_g2g60_3",S="_form_g2g60_3",C="_formContainer_g2g60_41",w="_formGroup_g2g60_55",E="_formLabel_g2g60_69",I="_required_g2g60_87",T="_formInput_g2g60_99",M="_formSelect_g2g60_101",q="_formTextarea_g2g60_103",k="_characterCount_g2g60_187",F="_inputError_g2g60_203",U="_errorMessage_g2g60_219",A="_submitError_g2g60_235",G="_uploadArea_g2g60_275",B="_fileInput_g2g60_283",L="_uploadLabel_g2g60_291",R="_uploadHint_g2g60_353",P="_previewGrid_g2g60_367",$="_previewItem_g2g60_381",O="_previewImage_g2g60_397",W="_removeButton_g2g60_409",H="_submitButton_g2g60_467",V="_spinner_g2g60_537",t={formSection:N,form:S,formContainer:C,formGroup:w,formLabel:E,required:I,formInput:T,formSelect:M,formTextarea:q,characterCount:k,inputError:F,errorMessage:U,submitError:A,uploadArea:G,fileInput:B,uploadLabel:L,uploadHint:R,previewGrid:P,previewItem:$,previewImage:O,removeButton:W,submitButton:H,spinner:V},Y=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],J=["Cyclist","Pedestrian","Motorcyclist"],K=["Fatal","Non-fatal"],z=["Male","Female","Non-binary","Other","Prefer not to say"];function x({label:h,name:l,type:i="text",placeholder:r,required:c,value:a,onChange:n,error:s,maxLength:u}){return e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{className:t.formLabel,htmlFor:l,children:[h,c&&e.jsx("span",{className:t.required,children:" *"})]}),e.jsx("input",{id:l,name:l,type:i,placeholder:r,value:a,onChange:n,maxLength:u,className:`${t.formInput} ${s?t.inputError:""}`,required:c}),s&&e.jsx("p",{className:t.errorMessage,children:s})]})}function y({label:h,name:l,options:i,required:r,value:c,onChange:a,error:n,placeholder:s}){return e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{className:t.formLabel,htmlFor:l,children:[h,r&&e.jsx("span",{className:t.required,children:" *"})]}),e.jsxs("select",{id:l,name:l,value:c,onChange:a,className:`${t.formSelect} ${n?t.inputError:""}`,required:r,children:[e.jsx("option",{value:"",children:s||`Select ${h}`}),i.map(u=>e.jsx("option",{value:u,children:u},u))]}),n&&e.jsx("p",{className:t.errorMessage,children:n})]})}function D({label:h,name:l,placeholder:i,required:r,value:c,onChange:a,error:n,maxLength:s}){const u=c?c.length:0;return e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{className:t.formLabel,htmlFor:l,children:[h,r&&e.jsx("span",{className:t.required,children:" *"})]}),e.jsx("textarea",{id:l,name:l,placeholder:i,value:c,onChange:a,maxLength:s,className:`${t.formTextarea} ${n?t.inputError:""}`,required:r,rows:6}),s&&e.jsxs("div",{className:t.characterCount,children:[u," / ",s," characters"]}),n&&e.jsx("p",{className:t.errorMessage,children:n})]})}function Q({label:h,name:l,required:i,images:r,onChange:c,error:a,maxImages:n=10}){const[s,u]=_.useState([]),j=o=>{const m=Array.from(o.target.files),p=n-r.length;if(m.length+r.length>n){alert(`You can only upload up to ${n} images`);return}const d=[];m.slice(0,p).forEach(g=>{if(g.type.startsWith("image/")){const v=new FileReader;v.onloadend=()=>{d.push({file:g,preview:v.result,id:Date.now()+Math.random()}),d.length===m.slice(0,p).length&&(u([...s,...d]),c([...r,...d]))},v.readAsDataURL(g)}})},f=o=>{const m=s.filter((d,g)=>g!==o),p=r.filter((d,g)=>g!==o);u(m),c(p)};return _.useEffect(()=>{r.length===0&&u([])},[r]),e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{className:t.formLabel,children:[h,i&&e.jsx("span",{className:t.required,children:" *"})]}),s.length<n&&e.jsxs("div",{className:t.uploadArea,children:[e.jsx("input",{id:l,name:l,type:"file",accept:"image/*",multiple:!0,onChange:j,className:t.fileInput}),e.jsxs("label",{htmlFor:l,className:t.uploadLabel,children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})}),e.jsx("span",{children:"Click to upload photos"}),e.jsxs("span",{className:t.uploadHint,children:[s.length," / ",n," images uploaded"]})]})]}),s.length>0&&e.jsx("div",{className:t.previewGrid,children:s.map((o,m)=>e.jsxs("div",{className:t.previewItem,children:[e.jsx("img",{src:o.preview,alt:`Preview ${m+1}`,className:t.previewImage}),e.jsx("button",{type:"button",onClick:()=>f(m),className:t.removeButton,"aria-label":"Remove image",children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},o.id||m))}),a&&e.jsx("p",{className:t.errorMessage,children:a})]})}function re({onSubmit:h,isSubmitting:l,actionData:i}){const[r,c]=_.useState({submitterName:"",submitterEmail:"",victimName:"",relation:"",incidentDate:"",state:"",roadUserType:"",injuryType:"",age:"",gender:"",shortTitle:"",victimStory:"",photos:[]}),[a,n]=_.useState({}),s=f=>{const{name:o,value:m}=f.target;c(p=>({...p,[o]:m})),a[o]&&n(p=>({...p,[o]:""}))},u=f=>{c(o=>({...o,photos:f}))},j=f=>{const o={};if(r.submitterName||(o.submitterName="Submitter name is required"),r.submitterEmail||(o.submitterEmail="Submitter email is required"),r.incidentDate||(o.incidentDate="Incident date is required"),r.state||(o.state="State is required"),r.roadUserType||(o.roadUserType="Road user type is required"),r.injuryType||(o.injuryType="Injury type is required"),r.shortTitle||(o.shortTitle="Short title is required"),r.victimStory||(o.victimStory="Victim's story is required"),Object.keys(o).length>0){f.preventDefault(),n(o);return}const m=f.target,p=m.querySelector('input[name="photoUrls"]');p&&p.remove();const d=document.createElement("input");if(d.type="hidden",d.name="photoUrls",r.photos.length>0){const g=r.photos.map(v=>v.preview);d.value=JSON.stringify(g)}else d.value=JSON.stringify([]);m.appendChild(d)};return _.useEffect(()=>{i!=null&&i.errors&&n(i.errors)},[i==null?void 0:i.errors]),e.jsx("div",{className:t.formSection,children:e.jsxs(b,{method:"post",onSubmit:j,className:t.form,children:[(i==null?void 0:i.error)&&e.jsxs("div",{className:t.submitError,children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),i.error]}),e.jsxs("div",{className:t.formContainer,children:[e.jsx(x,{label:"Submitter Name",name:"submitterName",placeholder:"Your full name",required:!0,value:r.submitterName,onChange:s,error:a.submitterName}),e.jsx(x,{label:"Submitter Email",name:"submitterEmail",type:"email",placeholder:"your@email.com",required:!0,value:r.submitterEmail,onChange:s,error:a.submitterEmail}),e.jsx(x,{label:"Victim Name",name:"victimName",placeholder:"Victim's full name (optional)",value:r.victimName,onChange:s,error:a.victimName}),e.jsx(x,{label:"Relation",name:"relation",placeholder:"Your relationship to the victim (optional)",value:r.relation,onChange:s,error:a.relation}),e.jsx(x,{label:"Incident Date",name:"incidentDate",type:"date",required:!0,value:r.incidentDate,onChange:s,error:a.incidentDate}),e.jsx(y,{label:"State",name:"state",options:Y,placeholder:"Select state",required:!0,value:r.state,onChange:s,error:a.state}),e.jsx(y,{label:"Road User Type",name:"roadUserType",options:J,placeholder:"Select road user type",required:!0,value:r.roadUserType,onChange:s,error:a.roadUserType}),e.jsx(y,{label:"Injury Type",name:"injuryType",options:K,placeholder:"Select injury type",required:!0,value:r.injuryType,onChange:s,error:a.injuryType}),e.jsx(x,{label:"Age at Incident",name:"age",type:"number",placeholder:"Age (optional)",value:r.age,onChange:s,error:a.age}),e.jsx(y,{label:"Gender",name:"gender",options:z,placeholder:"Select gender (optional)",value:r.gender,onChange:s,error:a.gender}),e.jsx(x,{label:"Short Title",name:"shortTitle",placeholder:"Brief title for this story",required:!0,value:r.shortTitle,onChange:s,error:a.shortTitle}),e.jsx(D,{label:"Victim's Story",name:"victimStory",placeholder:"Share the story... (max 1000 characters)",required:!0,maxLength:1e3,value:r.victimStory,onChange:s,error:a.victimStory}),e.jsx(Q,{label:"Photos",name:"photos",images:r.photos,onChange:u,error:a.photos,maxImages:10}),e.jsx("button",{type:"submit",className:t.submitButton,disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:t.spinner}),"Submitting..."]}):"Submit Story"})]})]})})}export{re as S};
